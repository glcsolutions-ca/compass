{
  "schemaVersion": "1",
  "guardrails": [
    {
      "guardrailId": "format.check",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-format.mjs",
      "passCodes": ["FMT000"],
      "failCodes": ["FMT001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "test.full-preflight",
      "owner": "@jrkropp",
      "entrypoint": "scripts/dev/test-full-preflight.mjs",
      "passCodes": ["FULL000"],
      "failCodes": ["FULL001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/agents/workflow-playbook.md#standard-agent-loop"
    },
    {
      "guardrailId": "high-risk.mainline-policy",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-high-risk-mainline-policy.mjs",
      "passCodes": ["NOT_MAIN_BRANCH", "NO_STAGED_FILES", "NO_HIGH_RISK_MATCHES"],
      "failCodes": ["HIGH_RISK_MAINLINE_PR_REQUIRED", "CCS_UNEXPECTED_ERROR"],
      "ref": "tests/policy/README.md#troubleshooting"
    },
    {
      "guardrailId": "testing.policy",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-testing-policy.mjs",
      "passCodes": ["TC000"],
      "failCodes": ["TC001", "TC010", "TC011", "TC020", "CCS_UNEXPECTED_ERROR"],
      "ref": "tests/policy/README.md#troubleshooting"
    },
    {
      "guardrailId": "web.constitution-policy",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-web-constitution.mjs",
      "passCodes": ["WEB000"],
      "failCodes": ["WEB001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/architecture/frontend-constitution.md"
    },
    {
      "guardrailId": "terminology.policy",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-terminology-policy.mjs",
      "passCodes": ["TERM000"],
      "failCodes": ["TERM001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "service-bus.auth-contract",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-service-bus-auth-contract.mjs",
      "passCodes": ["SB000"],
      "failCodes": ["SB001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md"
    },
    {
      "guardrailId": "db.migration-policy",
      "owner": "@jrkropp",
      "entrypoint": "db/scripts/check-migration-policy.mjs",
      "passCodes": ["MIG000", "MIGW000"],
      "failCodes": ["MIG001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/agents/workflow-playbook.md#standard-agent-loop"
    },
    {
      "guardrailId": "docs.drift",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-docs-drift.mjs",
      "passCodes": ["DOCS_DRIFT_PASS", "DOCS_DRIFT_ADVISORY_DOC_TARGET_MISSING"],
      "failCodes": ["DOCS_DRIFT_BLOCKING_DOC_TARGET_MISSING", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md#docs-drift"
    },
    {
      "guardrailId": "commit-stage.decision",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/decide-commit-stage.mjs",
      "passCodes": ["COMMIT_STAGE_PASS"],
      "failCodes": [
        "CHECK_DETERMINE_SCOPE_NOT_SUCCESS",
        "CHECK_RUNTIME_FAST_FEEDBACK_REQUIRED_NOT_SUCCESS",
        "CHECK_DESKTOP_FAST_FEEDBACK_REQUIRED_NOT_SUCCESS",
        "CHECK_INFRA_STATIC_CHECK_REQUIRED_NOT_SUCCESS",
        "CHECK_IDENTITY_STATIC_CHECK_REQUIRED_NOT_SUCCESS",
        "DOCS_DRIFT_BLOCKING_NOT_PASS",
        "COMMIT_STAGE_SLO_NOT_MET",
        "CCS_UNEXPECTED_ERROR"
      ],
      "ref": "docs/commit-stage-policy.md#commit-stage-checks"
    },
    {
      "guardrailId": "integration-gate.decision",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/decide-integration-gate.mjs",
      "passCodes": ["INTEGRATION_GATE_PASS"],
      "failCodes": [
        "CHECK_DETERMINE_SCOPE_NOT_SUCCESS",
        "CHECK_BUILD_COMPILE_REQUIRED_NOT_SUCCESS",
        "CHECK_MIGRATION_SAFETY_REQUIRED_NOT_SUCCESS",
        "CHECK_RUNTIME_CONTRACT_SMOKE_REQUIRED_NOT_SUCCESS",
        "CHECK_MINIMAL_INTEGRATION_SMOKE_REQUIRED_NOT_SUCCESS",
        "DOCS_DRIFT_BLOCKING_NOT_PASS",
        "CCS_UNEXPECTED_ERROR"
      ],
      "ref": "docs/commit-stage-policy.md#integration-gate-checks"
    },
    {
      "guardrailId": "scope.resolve",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/resolve-scope.mjs",
      "passCodes": ["SCOPE000"],
      "failCodes": ["SCOPE001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md#objective"
    },
    {
      "guardrailId": "runtime.coverage",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/check-runtime-coverage.mjs",
      "passCodes": ["RCOV000"],
      "failCodes": ["RCOV001", "CCS_UNEXPECTED_ERROR"],
      "ref": "tests/policy/README.md#layer-4-runtime-coverage-ratchet-observe-first"
    },
    {
      "guardrailId": "main.auto-recover",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/commit/auto-recover-main.mjs",
      "passCodes": ["AUTO_RECOVER_HANDLED"],
      "failCodes": ["CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md#mainline-red-recovery"
    },
    {
      "guardrailId": "release-candidate.classify",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/classify-release-candidate-kind.mjs",
      "passCodes": ["RCCLASS000"],
      "failCodes": ["RCCLASS001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md"
    },
    {
      "guardrailId": "codex-review.trusted",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/codex-review-trusted.mjs",
      "passCodes": ["CODEX_REVIEW_TRUSTED_PASS"],
      "failCodes": ["CODEX_REVIEW_TRUSTED_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/agents/troubleshooting.md#codex-review-trusted-failure"
    },
    {
      "guardrailId": "timing.cloud-deployment-stage",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/collect-cloud-deployment-stage-timing.mjs",
      "passCodes": ["CLOUD_TIMING000"],
      "failCodes": ["CLOUD_TIMING001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "timing.commit-stage",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/collect-commit-stage-timing.mjs",
      "passCodes": ["COMMIT_TIMING000"],
      "failCodes": ["COMMIT_TIMING001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md#commit-stage-timing-slo"
    },
    {
      "guardrailId": "timing.integration-gate",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/collect-integration-gate-metrics.mjs",
      "passCodes": ["INTEGRATION_TIMING000"],
      "failCodes": ["INTEGRATION_TIMING001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/commit-stage-policy.md#integration-gate-throughput-telemetry"
    },
    {
      "guardrailId": "release.decision",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/decide-release-outcome.mjs",
      "passCodes": ["RELEASE_DECISION_YES"],
      "failCodes": ["RELEASE_DECISION_NO", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/agents/troubleshooting.md#deployment-stage-failure"
    },
    {
      "guardrailId": "release-candidate.freeze-refs",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/freeze-release-candidate-refs.mjs",
      "passCodes": ["FREEZE_REFS000"],
      "failCodes": ["FREEZE_REFS001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "production-sha.resolve",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/get-last-production-sha.mjs",
      "passCodes": ["LAST_PROD_SHA000"],
      "failCodes": ["LAST_PROD_SHA001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "release-candidate.contract-load",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/load-release-candidate-contract.mjs",
      "passCodes": ["RCCONTRACT000"],
      "failCodes": ["RCCONTRACT001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "triggered-run.resolve",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/resolve-triggered-run-id.mjs",
      "passCodes": ["TRIGGERED_RUN000"],
      "failCodes": ["TRIGGERED_RUN001", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "identity.config-validate",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/validate-identity-config.mjs",
      "passCodes": ["IDENTITY_CONFIG_PASS"],
      "failCodes": [
        "IDENTITY_REQUIRED_ENV_MISSING",
        "IDENTITY_API_IDENTIFIER_URI_MISSING",
        "IDENTITY_API_IDENTIFIER_URI_INVALID_FORMAT",
        "IDENTITY_WEB_CUSTOM_DOMAIN_INVALID_FORMAT",
        "IDENTITY_WEB_CUSTOM_DOMAIN_INVALID",
        "IDENTITY_WEB_CUSTOM_DOMAIN_NON_ROUTABLE",
        "CCS_UNEXPECTED_ERROR"
      ],
      "ref": "docs/agents/troubleshooting.md#automated-acceptance-test-gate-failure"
    },
    {
      "guardrailId": "evidence.commit-stage-verify",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/verify-commit-stage-evidence.mjs",
      "passCodes": ["VERIFY_COMMIT_STAGE_EVIDENCE_PASS"],
      "failCodes": ["VERIFY_COMMIT_STAGE_EVIDENCE_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/runbooks/cloud-deployment-pipeline-setup.md"
    },
    {
      "guardrailId": "evidence.integration-gate-verify",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/shared/verify-integration-gate-evidence.mjs",
      "passCodes": ["VERIFY_INTEGRATION_GATE_EVIDENCE_PASS"],
      "failCodes": ["VERIFY_INTEGRATION_GATE_EVIDENCE_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/runbooks/cloud-deployment-pipeline-setup.md"
    },
    {
      "guardrailId": "deployment.infra-apply",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/apply-infra.mjs",
      "passCodes": ["INFRA_APPLY_PASS"],
      "failCodes": ["INFRA_APPLY_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "deployment.release-candidate-fresh",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/assert-fresh-release-candidate.mjs",
      "passCodes": ["FRESH_HEAD_PASS"],
      "failCodes": ["FRESH_HEAD_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "deployment.custom-domain-dns",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/custom-domain-dns.mjs",
      "passCodes": ["CUSTOM_DOMAIN_DNS_PLAN"],
      "failCodes": ["CUSTOM_DOMAIN_DNS_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/runbooks/cloud-deployment-pipeline-setup.md"
    },
    {
      "guardrailId": "deployment.stage-decision",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/decide-deployment-stage.mjs",
      "passCodes": ["DEPLOYMENT_STAGE_PASS"],
      "failCodes": ["DEPLOYMENT_STAGE_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/agents/troubleshooting.md#deployment-stage-failure"
    },
    {
      "guardrailId": "deployment.release-record",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/record-release.mjs",
      "passCodes": ["RECORD_RELEASE_PASS"],
      "failCodes": ["RECORD_RELEASE_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "deployment.migration-start",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/start-migration-job.mjs",
      "passCodes": ["MIGRATION_START_PASS"],
      "failCodes": ["MIGRATION_START_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/runbooks/migration-safety.md"
    },
    {
      "guardrailId": "deployment.keyvault-secrets-validate",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/validate-keyvault-secrets.mjs",
      "passCodes": ["KEYVAULT_SECRETS_PASS"],
      "failCodes": ["KEYVAULT_SECRETS_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/runbooks/cloud-deployment-pipeline-setup.md"
    },
    {
      "guardrailId": "deployment.agent-runtime-compatibility",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/verify-agent-runtime-compatibility.mjs",
      "passCodes": ["AGENT_RUNTIME_COMPATIBILITY_PASS"],
      "failCodes": [
        "AGENT_RUNTIME_POOL_ENDPOINT_INVALID",
        "AGENT_RUNTIME_VERIFIER_AUTHORIZATION_FAILED",
        "AGENT_RUNTIME_BOOTSTRAP_FAILED",
        "AGENT_RUNTIME_IDENTIFIER_STICKINESS_FAILED",
        "AGENT_RUNTIME_IDENTIFIER_ISOLATION_FAILED",
        "AGENT_RUNTIME_THREAD_STICKINESS_FAILED",
        "AGENT_RUNTIME_THREAD_ISOLATION_FAILED",
        "AGENT_RUNTIME_TURN_START_FAILED",
        "AGENT_RUNTIME_TURN_OUTPUT_MISSING",
        "AGENT_RUNTIME_INTERRUPT_FAILED",
        "AGENT_RUNTIME_COMPATIBILITY_RUNTIME_ERROR",
        "CCS_UNEXPECTED_ERROR"
      ],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "deployment.api-smoke",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/verify-api-smoke.mjs",
      "passCodes": ["API_SMOKE_PASS"],
      "failCodes": [
        "API_SMOKE_RUNTIME_ERROR",
        "API_SMOKE_ASSERTION_FAILED",
        "CCS_UNEXPECTED_ERROR"
      ],
      "ref": "docs/agents/troubleshooting.md#deployment-stage-failure"
    },
    {
      "guardrailId": "deployment.dynamic-sessions-convergence",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/verify-dynamic-sessions-convergence.mjs",
      "passCodes": ["DYNAMIC_SESSIONS_CONVERGENCE_PASS"],
      "failCodes": ["DYNAMIC_SESSIONS_CONVERGENCE_RUNTIME_ERROR", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "deployment.worker-servicebus-cutover",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/verify-worker-servicebus-cutover.mjs",
      "passCodes": ["WORKER_SERVICEBUS_CUTOVER_PASS"],
      "failCodes": ["WORKER_SERVICEBUS_CUTOVER_FAIL", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/ccs.md#output-format"
    },
    {
      "guardrailId": "deployment.migration-wait",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/cloud/deployment-stage/wait-migration-job.mjs",
      "passCodes": ["MIGRATION_WAIT_PASS"],
      "failCodes": [
        "MIGRATION_EXECUTION_QUERY_ERROR",
        "MIGRATION_EXECUTION_FAILED",
        "MIGRATION_EXECUTION_TIMEOUT",
        "CCS_UNEXPECTED_ERROR"
      ],
      "ref": "docs/runbooks/migration-safety.md"
    },
    {
      "guardrailId": "desktop.backend-contract-acceptance",
      "owner": "@jrkropp",
      "entrypoint": "scripts/pipeline/desktop/automated-acceptance-test-gate/run-desktop-backend-contract-acceptance.mjs",
      "passCodes": ["DESKTOP_BACKEND_CONTRACT_PASS"],
      "failCodes": ["DESKTOP_BACKEND_CONTRACT_NOT_PASS", "CCS_UNEXPECTED_ERROR"],
      "ref": "docs/agents/troubleshooting.md#automated-acceptance-test-gate-failure"
    }
  ]
}
