{
  "version": "1",
  "scopeRules": {
    "runtime": [
      "apps/api/**",
      "apps/web/**",
      "apps/codex-app-server/**",
      "apps/worker/**",
      "packages/**",
      "db/migrations/**",
      "db/scripts/**",
      "apps/api/Dockerfile",
      "apps/web/Dockerfile",
      "apps/codex-app-server/Dockerfile",
      "package.json",
      "pnpm-lock.yaml",
      "pnpm-workspace.yaml",
      "**/package.json"
    ],
    "desktop": [
      "apps/desktop/**",
      ".github/workflows/desktop-deployment-pipeline.yml",
      ".github/workflows/desktop-release.yml"
    ],
    "infra": ["infra/azure/**"],
    "identity": ["infra/identity/**"],
    "migration": ["db/migrations/**", "db/scripts/**"],
    "infraRollout": [
      "infra/azure/main.bicep",
      "infra/azure/modules/containerapp-*.bicep",
      "infra/azure/modules/containerapps-env.bicep",
      "infra/azure/environments/*.bicepparam",
      "infra/azure/environments/**"
    ],
    "docsOnly": [
      "docs/**",
      "README.md",
      "CONTRIBUTING.md",
      "AGENTS.md",
      ".github/workflows/**",
      ".github/policy/**",
      "scripts/pipeline/**",
      "apps/**/README.md",
      "packages/**/README.md",
      "scripts/**/README.md",
      "tests/**/README.md",
      "infra/**/README.md"
    ]
  },
  "commitStage": {
    "requiredChecks": ["determine-scope", "fast-feedback", "desktop-fast-feedback", "commit-stage"],
    "slo": {
      "targetSeconds": 300,
      "mode": "enforce"
    }
  },
  "acceptanceStage": {
    "requiredFlowIds": ["compass-smoke"],
    "runtimeRequiredChecks": [
      "runtime-api-system-acceptance",
      "runtime-browser-acceptance",
      "runtime-migration-image-acceptance"
    ],
    "infraRequiredChecks": ["infra-readonly-acceptance"],
    "identityRequiredChecks": ["identity-readonly-acceptance"]
  },
  "productionStage": {
    "requireFreshHeadOnAuto": true
  },
  "cloudDeploymentPipeline": {
    "slo": {
      "mode": "observe",
      "acceptanceTargetSeconds": 900,
      "productionTargetSeconds": 1200
    }
  },
  "desktopPipeline": {
    "requiredChecks": [
      "desktop-commit-stage",
      "desktop-acceptance-stage",
      "desktop-production-stage",
      "desktop-release-decision"
    ],
    "artifactContracts": {
      "candidateManifestPath": ".artifacts/desktop-candidate/<sha>/manifest.json",
      "acceptanceResultPath": ".artifacts/desktop-acceptance/<sha>/result.json",
      "productionResultPath": ".artifacts/desktop-production/<sha>/result.json",
      "releaseDecisionPath": ".artifacts/desktop-release/<sha>/decision.json"
    },
    "slo": {
      "mode": "observe",
      "acceptanceTargetSeconds": 1800,
      "productionTargetSeconds": 1200
    }
  },
  "docsDriftRules": {
    "blockingPaths": [
      ".github/workflows/*.yml",
      ".github/workflows/*.yaml",
      ".github/policy/**",
      "scripts/pipeline/**",
      "infra/azure/**",
      "infra/identity/**",
      "deploy/**"
    ],
    "docsCriticalPaths": [
      "contracts/**",
      "schemas/**",
      "openapi/**",
      "proto/**",
      "db/migrations/**",
      "db/scripts/**",
      "config/**",
      "infra/**",
      "infra/azure/**",
      "infra/identity/**",
      "packages/contracts/**",
      "packages/contracts/openapi/**"
    ],
    "docTargets": [
      "docs/commit-stage-policy.md",
      "docs/branch-protection.md",
      ".github/policy/README.md",
      ".github/workflows/README.md",
      "docs/contracts/**",
      "docs/runbooks/**"
    ]
  }
}
