@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light;
  }

  :root.dark {
    color-scheme: dark;
  }

  :root,
  :root[data-theme="compass"] {
    --background: 0 0% 97%;
    --foreground: 220 13% 12%;
    --card: 0 0% 100%;
    --card-foreground: 220 13% 12%;
    --popover: 0 0% 100%;
    --popover-foreground: 220 13% 12%;
    --primary: 217 100% 56%;
    --primary-foreground: 0 0% 100%;
    --secondary: 210 20% 93%;
    --secondary-foreground: 222 15% 20%;
    --muted: 210 20% 93%;
    --muted-foreground: 214 11% 42%;
    --accent: 210 20% 93%;
    --accent-foreground: 222 15% 20%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    --border: 214 18% 88%;
    --input: 214 18% 88%;
    --ring: 217 100% 56%;
    --radius: 0.65rem;
    --sidebar: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;

    /* assistant-ui tokens map onto existing shadcn semantic tokens */
    --aui-background: var(--background);
    --aui-foreground: var(--foreground);
    --aui-card: var(--card);
    --aui-card-foreground: var(--card-foreground);
    --aui-popover: var(--popover);
    --aui-popover-foreground: var(--popover-foreground);
    --aui-primary: var(--primary);
    --aui-primary-foreground: var(--primary-foreground);
    --aui-secondary: var(--secondary);
    --aui-secondary-foreground: var(--secondary-foreground);
    --aui-muted: var(--muted);
    --aui-muted-foreground: var(--muted-foreground);
    --aui-accent: var(--accent);
    --aui-accent-foreground: var(--accent-foreground);
    --aui-destructive: var(--destructive);
    --aui-destructive-foreground: var(--destructive-foreground);
    --aui-border: var(--border);
    --aui-input: var(--input);
    --aui-ring: var(--ring);
    --aui-radius: var(--radius);
    --compass-chat-max-width: clamp(48rem, 70vw, 58rem);
    --aui-thread-max-width: var(--compass-chat-max-width);
  }

  :root.dark,
  :root[data-theme="compass"].dark {
    --background: 220 13% 8%;
    --foreground: 210 20% 96%;
    --card: 220 14% 11%;
    --card-foreground: 210 20% 96%;
    --popover: 220 14% 11%;
    --popover-foreground: 210 20% 96%;
    --primary: 217 100% 65%;
    --primary-foreground: 220 13% 8%;
    --secondary: 220 12% 18%;
    --secondary-foreground: 210 20% 92%;
    --muted: 220 12% 18%;
    --muted-foreground: 215 16% 70%;
    --accent: 220 12% 18%;
    --accent-foreground: 210 20% 92%;
    --destructive: 0 63% 44%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 12% 22%;
    --input: 220 12% 22%;
    --ring: 217 100% 65%;
    --sidebar: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }

  :root[data-theme="slate"] {
    --primary: 215 20% 42%;
    --ring: 215 20% 42%;
    --sidebar-primary: 215 25% 28%;
    --sidebar-accent: 215 20% 92%;
    --sidebar-accent-foreground: 215 25% 24%;
    --sidebar-ring: 215 20% 42%;
  }

  :root[data-theme="slate"].dark {
    --primary: 215 20% 62%;
    --ring: 215 20% 62%;
    --sidebar-primary: 215 28% 66%;
    --sidebar-accent: 217 19% 20%;
    --sidebar-accent-foreground: 214 20% 92%;
    --sidebar-ring: 215 20% 62%;
  }

  :root[data-theme="rose"] {
    --primary: 346 77% 49%;
    --ring: 346 77% 49%;
    --sidebar-primary: 346 72% 43%;
    --sidebar-accent: 346 35% 93%;
    --sidebar-accent-foreground: 346 35% 24%;
    --sidebar-ring: 346 77% 49%;
  }

  :root[data-theme="rose"].dark {
    --primary: 346 77% 60%;
    --ring: 346 77% 60%;
    --sidebar-primary: 346 70% 64%;
    --sidebar-accent: 346 35% 19%;
    --sidebar-accent-foreground: 346 28% 92%;
    --sidebar-ring: 346 77% 60%;
  }

  * {
    @apply border-border;
  }

  html,
  body,
  #root {
    height: 100%;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: "Inter", "Segoe UI", sans-serif;
  }
}

/* Keep assistant-ui overrides outside Tailwind layers to avoid JIT pruning. */
.aui-thread-root {
  @apply flex h-full min-h-0 w-full flex-col bg-transparent;
  margin-inline: auto;
  max-width: var(--aui-thread-max-width);
}

.aui-chat-sidebar-panel {
  @apply h-full min-h-0 w-full rounded-2xl border border-border/70 bg-background/70 lg:w-[min(42rem,52vw)];
  --aui-thread-max-width: min(100%, 42rem);
}

.aui-chat-sidebar-panel .aui-thread-root {
  max-width: 100%;
}

.aui-thread-viewport {
  @apply w-full px-4 pt-6 md:px-6;
  scrollbar-gutter: stable both-edges;
}

.aui-thread-viewport-footer {
  @apply w-full pb-4;
  margin-inline: auto;
}

.aui-thread-followup-suggestions {
  @apply mt-2;
}

.aui-composer-root {
  @apply rounded-2xl border border-border/80 bg-background/95 shadow-sm backdrop-blur;
}

.aui-composer-input {
  @apply text-sm leading-relaxed;
}

.aui-composer-dictate {
  @apply inline-flex h-8 w-8 items-center justify-center rounded-full border border-border/70 bg-background text-foreground transition-colors hover:bg-accent;
}

.aui-composer-quote {
  @apply mx-2 mt-2 flex items-center gap-2 rounded-md border border-border/70 bg-muted/50 px-2 py-1;
}

.aui-composer-quote-text {
  @apply line-clamp-1 flex-1 text-xs text-muted-foreground;
}

.aui-composer-quote-dismiss {
  @apply inline-flex h-5 w-5 items-center justify-center rounded text-muted-foreground hover:bg-accent hover:text-accent-foreground;
}

.aui-thread-list-root {
  @apply flex flex-col gap-1;
}

.aui-thread-list-item {
  @apply flex items-center gap-1 rounded-md;
}

.aui-thread-list-item-trigger {
  @apply min-w-0 flex-1 rounded-md px-2 py-1.5 text-sidebar-foreground transition-colors hover:bg-sidebar-accent hover:text-sidebar-accent-foreground;
}

.aui-thread-list-item-trigger[data-active="true"] {
  @apply bg-sidebar-accent text-sidebar-accent-foreground;
}

.aui-thread-list-item-title {
  @apply truncate text-xs;
}

.aui-thread-list-item-actions {
  @apply mr-1 flex items-center gap-1;
}

.aui-thread-list-item-action {
  @apply inline-flex h-7 w-7 items-center justify-center rounded-md text-sidebar-foreground/65 transition-colors hover:bg-sidebar-accent hover:text-sidebar-accent-foreground;
}

.aui-thread-list-item-action-danger {
  @apply text-destructive/80 hover:bg-destructive/15 hover:text-destructive;
}

.aui-selection-toolbar {
  @apply z-30 rounded-md border border-border/80 px-1 py-1 shadow-md;
  background-color: hsl(var(--popover));
}

.aui-selection-toolbar-quote {
  @apply rounded px-2 py-1 text-xs font-medium hover:bg-accent;
  color: hsl(var(--popover-foreground));
}

@layer utilities {
  .shell-surface {
    background-image: linear-gradient(to bottom, hsl(var(--background)), hsl(var(--background)));
  }
}
